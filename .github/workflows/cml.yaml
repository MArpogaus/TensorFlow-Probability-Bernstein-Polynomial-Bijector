name: "train and evaluate model"
on: [push]
jobs:
  run:
     runs-on: [ubuntu-latest]
     container: docker://dvcorg/cml-py3:latest
     steps:
        - uses: actions/checkout@v2
        - name: cml_run
           env:
              repo_token: ${{ secrets.GITHUB_TOKEN }}
           run: |
              pip install .
              python cml/old_faithful.py

              echo '# Old Faithful' >> report.md
              
              echo '## Learning Curve' >> report.md
              cml-publish of_hist.png --md >> report.md

              echo '## Metrics' >> report.md
              cat of_metrics.txt >> report.md
              
              echo '## Parameter Vector' >> report.md
              cat of_pvector.txt >> report.md
              
              echo '## Results' >> report.md
              cml-publish of_dist.png --md >> report.md
              cml-send-comment report.md
